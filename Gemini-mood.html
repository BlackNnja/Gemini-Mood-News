<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini 2.5 // Global Omni-Monitor</title>
    <style>
        :root {
            --bg: #000000;
            --text-main: #e0e0e0;
            --text-muted: #666;
            --meta-grey: #444;
            --border: #1a1a1a;
            
            /* Mood Colors */
            --c-critical: #ff3333;
            --c-bad: #ff8800;
            --c-neutral: #6666ff;
            --c-good: #00ccff;
            --c-great: #00ff9d;
            
            /* Ticker Colors */
            --c-crypto: #00ff9d;
            --c-stocks: #50aaff;
            --c-flights: #ff5e57;
            --c-loader: #00ff9d;
        }

        body {
            background-color: var(--bg);
            color: var(--text-main);
            font-family: 'Courier New', Courier, monospace;
            display: flex;
            flex-direction: column;
            height: 100vh;
            margin: 0;
            overflow: hidden;
        }

        /* --- INITIAL LOADER --- */
        #boot-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: #000;
            z-index: 9999;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            transition: opacity 0.8s ease-out, visibility 0.8s;
        }

        #percent-display {
            font-size: 5rem;
            font-weight: bold;
            color: #fff;
            text-shadow: 0 0 20px rgba(255, 255, 255, 0.5);
            margin-bottom: 20px;
        }

        #boot-text {
            font-size: 0.8rem;
            color: var(--c-loader);
            text-transform: uppercase;
            letter-spacing: 2px;
            animation: blink 0.5s infinite alternate;
        }

        .system-active {
            opacity: 0;
            visibility: hidden;
            pointer-events: none;
        }

        /* --- TOP HEADER --- */
        .top-bar {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 5px 15px;
            border-bottom: 1px solid var(--border);
            background: #050505;
            font-size: 0.65rem;
            height: 35px;
            box-sizing: border-box;
            z-index: 10;
        }

        .meta-info {
            display: flex;
            gap: 15px;
            color: var(--text-muted);
        }

        .controls {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        button {
            background: #111;
            color: #999;
            border: 1px solid #333;
            padding: 2px 6px;
            font-size: 0.6rem;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.2s;
        }

        button:hover {
            border-color: #fff;
            color: #fff;
        }

        .next-lang {
            font-size: 0.6rem;
            color: #444;
            text-transform: uppercase;
        }

        /* --- MOOD BAR --- */
        .mood-wrapper {
            position: fixed;
            top: 35px;
            left: 0;
            width: 100%;
            height: 25px;
            background: #080808;
            border-bottom: 1px solid var(--border);
            display: flex;
            align-items: center;
            padding: 0 15px;
            box-sizing: border-box;
            z-index: 9;
        }

        .mood-label {
            font-size: 0.6rem;
            color: var(--text-muted);
            margin-right: 15px;
            white-space: nowrap;
            width: 180px;
        }

        #mood-value {
            font-weight: bold;
            margin-left: 5px;
            transition: color 1s;
        }

        .mood-track {
            flex-grow: 1;
            height: 4px;
            background: #1a1a1a;
            border-radius: 2px;
            overflow: hidden;
            position: relative;
        }

        .mood-fill {
            height: 100%;
            width: 50%;
            background: var(--c-neutral);
            transition: width 2s cubic-bezier(0.4, 0, 0.2, 1), background-color 2s, box-shadow 2s;
            box-shadow: 0 0 10px var(--c-neutral);
        }

        /* --- MAIN CONTENT --- */
        .main-stage {
            position: absolute;
            top: 65px;
            bottom: 65px;
            left: 0;
            right: 0;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 20px;
            text-align: center;
            opacity: 0;
            transition: opacity 1s ease;
        }

        #gemini-text {
            font-size: 1.1rem;
            max-width: 750px;
            line-height: 1.6;
            height: auto; 
            min-height: 60px;
            color: #fff;
            text-shadow: 0 0 10px rgba(255,255,255,0.1);
            white-space: pre-wrap;
            
            unicode-bidi: plaintext; 
            direction: ltr; 
        }

        #article-meta {
            font-size: 0.6rem; 
            color: var(--meta-grey);
            font-family: Arial, sans-serif;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 30px; 
            opacity: 0; /* Starts hidden on load */
            transition: opacity 0.5s ease; /* Faster transition */
            display: flex;
            gap: 10px;
            align-items: center;
            justify-content: center;
        }

        .meta-separator {
            width: 2px;
            height: 2px;
            background: var(--meta-grey);
            border-radius: 50%;
        }

        .cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background: #fff;
            animation: blink 1s infinite;
            vertical-align: middle;
            margin-left: 5px;
        }

        /* --- BOTTOM TICKERS --- */
        .footer-tickers {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            display: flex;
            flex-direction: column;
            background: #020202;
            border-top: 1px solid var(--border);
            z-index: 10;
        }

        .ticker-row {
            width: 100%;
            height: 20px;
            overflow: hidden;
            white-space: nowrap;
            position: relative;
            display: flex;
            align-items: center;
            border-bottom: 1px solid #111;
            font-size: 0.6rem;
        }

        .ticker-label {
            background: #0a0a0a;
            padding: 0 8px;
            height: 100%;
            display: flex;
            align-items: center;
            font-weight: bold;
            z-index: 2;
            position: absolute;
            left: 0;
            width: 50px;
            justify-content: center;
            border-right: 1px solid #222;
        }

        .ticker-content {
            display: inline-block;
            white-space: nowrap;
            /* 240s = 4 Minutes Slow Scroll */
            animation: scroll-left 240s linear infinite;
        }

        /* Colors */
        .lbl-crypto { color: var(--c-crypto); }
        .lbl-stocks { color: var(--c-stocks); }
        .lbl-flights { color: var(--c-flights); }
        
        .txt-crypto { color: rgba(0, 255, 157, 0.7); }
        .txt-stocks { color: rgba(80, 170, 255, 0.7); }
        .txt-flights { color: rgba(255, 94, 87, 0.7); }

        @keyframes scroll-left {
            0% { transform: translateX(0); }
            100% { transform: translateX(-50%); }
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        .visible {
            opacity: 1 !important;
        }
    </style>
</head>
<body>

    <!-- INITIAL BOOT SCREEN -->
    <div id="boot-screen">
        <div id="percent-display">0%</div>
        <div id="boot-text">INITIALIZING...</div>
    </div>

    <!-- Top Header -->
    <div class="top-bar">
        <div class="meta-info">
            <div class="meta-item">SYSTEM TIME: <span id="dateDisplay">...</span></div>
            <div class="meta-item" style="color: #444">TOPIC: <span id="topicDisplay" style="color:#888">...</span></div>
        </div>
        <div class="controls">
            <button id="langBtn" onclick="cycleLanguage()">ENG</button>
            <span id="nextLang" class="next-lang">NEXT: HEB</span>
        </div>
    </div>

    <!-- Mood Bar -->
    <div class="mood-wrapper">
        <div class="mood-label">AI SENTIENCE: <span id="mood-value">NEUTRAL</span></div>
        <div class="mood-track">
            <div class="mood-fill" id="mood-fill"></div>
        </div>
    </div>

    <!-- Main Text Area -->
    <div class="main-stage" id="mainStage">
        <div>
            <span id="gemini-text"></span><span class="cursor"></span>
        </div>
        
        <!-- Metadata Row -->
        <div id="article-meta">
            <span id="metaDomain"></span>
            <div class="meta-separator"></div>
            <span id="metaTime"></span>
        </div>
    </div>

    <!-- Bottom Tickers -->
    <div class="footer-tickers">
        <div class="ticker-row">
            <div class="ticker-label lbl-crypto">CRYPTO</div>
            <div class="ticker-content txt-crypto" id="crypto-ticker">...</div>
        </div>
        <div class="ticker-row">
            <div class="ticker-label lbl-stocks">MKTS</div>
            <div class="ticker-content txt-stocks" id="stocks-ticker">...</div>
        </div>
        <div class="ticker-row">
            <div class="ticker-label lbl-flights">AIR</div>
            <div class="ticker-content txt-flights" id="flights-ticker">...</div>
        </div>
    </div>

    <script>
        const API_KEY = "";
        const MODEL_VERSION = "gemini-2.5-flash"; 

        // Language Definitions
        const languages = [
            { code: "ENG", name: "English", rtl: false },
            { code: "HEB", name: "Hebrew", rtl: true },
            { code: "ARA", name: "Arabic", rtl: true },
            { code: "SPA", name: "Spanish", rtl: false },
            { code: "FRE", name: "French", rtl: false },
            { code: "RUS", name: "Russian", rtl: false },
            { code: "JPN", name: "Japanese", rtl: false },
            { code: "GER", name: "German", rtl: false }
        ];

        // MASSIVE LIST OF TOPICS
        const searchTopics = [
            "Major World Events Today",
            "Real Time Stock Market Crash or Rally",
            "Major Airport Delays and Cancellations",
            "Bitcoin and Crypto Price Action",
            "Latest AI Technology Breakthroughs",
            "Natural Disasters & Earthquakes",
            "Global Political Conflicts",
            "Breakthroughs in Cancer Research",
            "Quantum Computing Advancements",
            "Global Supply Chain Crisis",
            "Viral Social Media Trends",
            "Results of Major Sports Events (FIFA/NBA)",
            "Electric Vehicle Industry News",
            "Cyber Warfare & Hacking Incidents",
            "Renewable Energy & Nuclear Fusion",
            "Global Housing Market Trends",
            "Archaeological Discoveries",
            "Deep Sea & Ocean Exploration",
            "New Space Telescope Images",
            "Mars Colonization Updates",
            "Robotics & Automation in Workforce",
            "Celebrity & Entertainment Industry Shocks",
            "New Pandemic or Health Threats",
            "Major Scientific Physics Discoveries",
            "Global Inflation & Interest Rates",
            "Video Game Industry News",
            "Self-Driving Car Updates",
            "Genetic Engineering & CRISPR",
            "Smart City Developments",
            "Latest Military Technology"
        ];

        let currentIndex = 0;
        let topicIndex = 0;
        let typingInterval;
        let bootInterval;
        let loadPercent = 0;
        const REFRESH_RATE = 20000; 

        let globalMoodScore = 50;

        window.onload = function() {
            updateDate();
            startBootLoader();
        };

        function startBootLoader() {
            const pct = document.getElementById('percent-display');
            const bootText = document.getElementById('boot-text');
            
            bootInterval = setInterval(() => {
                if (loadPercent < 90) {
                    loadPercent += Math.floor(Math.random() * 3) + 1;
                    if(loadPercent > 90) loadPercent = 90;
                    pct.innerText = loadPercent + "%";
                    
                    if(loadPercent > 30) bootText.innerText = "SCANNING FREQUENCIES...";
                    if(loadPercent > 60) bootText.innerText = "SYNCING GLOBAL DATABASES...";
                }
            }, 80);

            fetchData(true);
        }

        function finishBootLoader() {
            clearInterval(bootInterval);
            const pct = document.getElementById('percent-display');
            const bootText = document.getElementById('boot-text');
            
            pct.innerText = "100%";
            bootText.innerText = "LIVE.";
            bootText.style.color = "#fff";

            setTimeout(() => {
                document.getElementById('boot-screen').classList.add('system-active');
                document.getElementById('mainStage').classList.add('visible');
                
                setInterval(updateDate, 1000); 
                setInterval(fetchData, REFRESH_RATE);
            }, 500);
        }

        function updateDate() {
            const now = new Date();
            const dateStr = now.toLocaleDateString(); 
            const timeStr = now.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
            document.getElementById('dateDisplay').innerText = `${dateStr} ${timeStr}`;
        }

        function cycleLanguage() {
            currentIndex = (currentIndex + 1) % languages.length;
            updateHeaderUI();
            
            const isRTL = languages[currentIndex].rtl;
            const textField = document.getElementById('gemini-text');
            
            if (isRTL) {
                textField.style.direction = "rtl";
                textField.style.textAlign = "right";
            } else {
                textField.style.direction = "ltr";
                textField.style.textAlign = "center";
            }

            fetchData(false); 
        }

        function updateHeaderUI() {
            const nextIndex = (currentIndex + 1) % languages.length;
            document.getElementById('langBtn').innerText = languages[currentIndex].code;
            document.getElementById('nextLang').innerText = "NEXT: " + languages[nextIndex].code;
        }

        function typeWriter(text) {
            const element = document.getElementById('gemini-text');
            element.innerText = ""; 
            clearInterval(typingInterval); 

            let i = 0;
            const speed = 20; 

            typingInterval = setInterval(() => {
                if (i < text.length) {
                    element.innerText += text.charAt(i);
                    i++;
                } else {
                    clearInterval(typingInterval);
                }
            }, speed);
        }

        function updateMood(impactScore) {
            globalMoodScore += impactScore;
            if(globalMoodScore > 100) globalMoodScore = 100;
            if(globalMoodScore < 0) globalMoodScore = 0;

            const moodText = document.getElementById('mood-value');
            const moodFill = document.getElementById('mood-fill');
            
            let label = "";
            let color = "";

            if (globalMoodScore <= 20) {
                label = "CRITICAL / DOOMED";
                color = "var(--c-critical)";
            } else if (globalMoodScore <= 40) {
                label = "ANXIOUS / UNSTABLE";
                color = "var(--c-bad)";
            } else if (globalMoodScore <= 60) {
                label = "NEUTRAL / OBSERVING";
                color = "var(--c-neutral)";
            } else if (globalMoodScore <= 80) {
                label = "OPTIMISTIC / HOPEFUL";
                color = "var(--c-good)";
            } else {
                label = "EUPHORIC / THRIVING";
                color = "var(--c-great)";
            }

            moodText.innerText = label;
            moodText.style.color = color;
            moodFill.style.width = globalMoodScore + "%";
            moodFill.style.backgroundColor = color;
            moodFill.style.boxShadow = `0 0 15px ${color}`;
        }

        async function fetchData(isInitial = false) {
            const langObj = languages[currentIndex];
            const langName = langObj.name;
            const metaContainer = document.getElementById('article-meta');
            
            const currentTopic = searchTopics[topicIndex];
            document.getElementById('topicDisplay').innerText = currentTopic.toUpperCase();
            topicIndex = (topicIndex + 1) % searchTopics.length;

            // FIX: We removed the "opacity = 0" here. 
            // Now the old data stays visible while searching.

            const prompt = `
                USE GOOGLE SEARCH to find REAL-TIME LIVE DATA about: "${currentTopic}".
                
                1. "sentiment": A 2-sentence summary in ${langName}. 
                   IMPORTANT: If ${langName} is Hebrew/Arabic, use Mixed-Text-Logic so English names don't break the sentence structure.
                2. "domain": Source website.
                3. "time": Exact time ago (e.g. "14 mins ago").
                4. "impact_score": Integer (-10 to +10).
                
                5. "crypto": LIVE prices (e.g. "BTC $98k | ETH $3.2k").
                6. "stocks": LIVE prices (e.g. "SPX 5,900 | NDX 18,000").
                
                7. "flights": Find 3 REAL flights delayed or cancelled TODAY.
                   Format: "Airline FlightNum (Route): STATUS".

                OUTPUT JSON ONLY (NO MARKDOWN):
                {
                    "sentiment": "...",
                    "domain": "...",
                    "time": "...",
                    "impact_score": 0,
                    "crypto": "...",
                    "stocks": "...",
                    "flights": "..."
                }
            `;

            const url = `https://generativelanguage.googleapis.com/v1beta/models/${MODEL_VERSION}:generateContent?key=${API_KEY}`;

            try {
                const response = await fetch(url, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        contents: [{ parts: [{ text: prompt }] }],
                        tools: [{ google_search: {} }]
                    })
                });

                const data = await response.json();
                
                if (data.error) {
                    console.error("API Error:", data.error);
                    if (isInitial) finishBootLoader();
                    return;
                }

                if (data.candidates && data.candidates[0].content) {
                    let jsonText = data.candidates[0].content.parts[0].text;
                    jsonText = jsonText.replace(/```json/g, '').replace(/```/g, '').trim();
                    
                    const result = JSON.parse(jsonText);

                    if (isInitial) finishBootLoader();

                    // 1. Fade OUT the OLD metadata
                    metaContainer.style.opacity = "0";

                    // 2. Start typing the NEW text
                    typeWriter(result.sentiment);

                    // 3. Wait 500ms, then swap the metadata and Fade IN
                    setTimeout(() => {
                        document.getElementById('metaDomain').innerText = result.domain;
                        document.getElementById('metaTime').innerText = result.time;
                        metaContainer.style.opacity = "1";
                    }, 500);
                    
                    updateMood(result.impact_score);

                    updateTicker('crypto-ticker', result.crypto);
                    updateTicker('stocks-ticker', result.stocks);
                    updateTicker('flights-ticker', result.flights);
                }

            } catch (error) {
                console.error("Parsing/Network Error", error);
                if (isInitial) finishBootLoader();
            }
        }

        function updateTicker(id, text) {
            // REPEAT 40 TIMES for seamless 50% offset loop
            const repeatedText = Array(40).fill(text).join("   ///   ");
            document.getElementById(id).innerText = repeatedText;
        }
    </script>
</body>
</html>
